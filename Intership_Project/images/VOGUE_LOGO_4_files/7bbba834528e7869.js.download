!function(){if(void 0===window.ometria||"function"!=typeof ometria.init){void 0!==window.ometria&&(window.ometria.init=function(){});var e=navigator.cookieEnabled||"cookie"in document&&(0<document.cookie.length||-1<(document.cookie="test").indexOf.call(document.cookie,"test"));if(e&&(!window.navigator||"preview"!==window.navigator.loadPurpose)){"#om_debug"==window.location.hash&&D("OMdebug","1",1),"#om_debug=off"==window.location.hash&&D("OMdebug","0",-1);var o,r,t="1"==q("OMdebug"),s=(_log=[],function(e){_log.push(e)}),P=function(e,t){_log.push([e,t])},l=function(e){_log.push(e),t&&console.log(["OMETRIA",e])},u={key:"7bbba834528e7869",endpoint:"//trk.ometria.com/track/",plugins:["observe_all_email_boxes","overlays_(remember to create overlay custom field)"],callback_timeout:250,cookie_expire_days:365,session_timeout:1800,api_version:3,payment_domains:["worldpay","paypal","myshopify","pay.shopify.com"],cookie_domain:".tangleteezer.com",remove_domain_prefixes:["www.","secure."],page_types:[],external_campaign_plugins:[],extra_plugin_code:"",cart_deeplink_url:"/checkout/cart"},d=(u.endpoint="https:"+u.endpoint,-1<window.location.host.indexOf("localhost")&&(u.endpoint="http://trk.ometria.localhost/track/"),t&&(o=null,r=[],s=function(e){Y(e),console.log(["OMETRIA",e,p])},P=function(e,t){var n,o;Y((n=t,o="Event: "+e,"pageview"==e&&(o+=" ("+n.type,"product"==n.type&&(o+=" #"+n.pid),o+=")"),"transaction"==e&&(o+=" ("+n.tid+")"),"checkout"==e&&(o+=" ("+n.stage+")"),o),t),console.log(["OMETRIA","Sending event",e,t,p])},l=function(e){console.log(["OMETRIA",e])}),{_keyStr:"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=",encode:function(e){var t,n,o,i,r,a,s="",c=0;for(e=d._utf8_encode(e);c<e.length;)o=(t=e.charCodeAt(c++))>>2,i=(3&t)<<4|(t=e.charCodeAt(c++))>>4,r=(15&t)<<2|(n=e.charCodeAt(c++))>>6,a=63&n,isNaN(t)?r=a=64:isNaN(n)&&(a=64),s=s+d._keyStr.charAt(o)+d._keyStr.charAt(i)+d._keyStr.charAt(r)+d._keyStr.charAt(a);return s},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var o=e.charCodeAt(n);t+=o<128?String.fromCharCode(o):"\\u"+("0000"+o.toString(16)).slice(-4)}return t}}),c=(R.prototype.get=function(e,t){return this.data.contains(e)?this.data.get(e):t},R.prototype.getInt=function(e,t){return parseInt(this.get(e,t))},R.prototype.appendText=function(e,t,n){n=n||"",this.changed=!0;var o=this.data.get(e)||"";o&&(o+=n),o+=t,this.data.set(e,t),this.saveSoon()},R.prototype.set=function(e,t){this.changed=!0,this.data.set(e,t),this.saveSoon()},R.prototype.saveSoon=function(e,t){var n=this;this.saveto&&clearTimeout(this.saveto),this.saveto=setTimeout(function(){n.saveto=null,n.save()},5)},R.prototype.inc=function(e,t){var n=this.getInt(e)||0;this.set(e,n+(t=t||1))},R.prototype.load=function(){var e=q(this.name);e&&(this.existed=!0,this.data=L(e))},R.prototype.save=function(){this.saveto&&(clearTimeout(this.saveto),this.saveto=null),D(this.name,X(this.data.toObject()),this.life,this.domain),this.checkforDoubleCookie(),this.changed=!1},R.prototype.checkforDoubleCookie=function(){var e=document.cookie.indexOf(this.name+"=");-1!=e&&-1!=document.cookie.indexOf(this.name+"=",e+1)&&(e=location.hostname,this.domain!=e)&&this.domain!="."+e&&(s("Erase cookie"),M(this.name,e),M(this.name,""))},R.prototype.saveIfDirty=function(){this.changed&&this.save()},[]);N.prototype.setData=function(e){for(var t in e)this[t]=e[t]},N.prototype.setProperties=function(e){this.p=e},N.prototype.addLineItem=function(e,t,n,o,i){var r;n=C(n),r=t,t=Math.floor(C(r)),"object"==typeof o&&(i=o,o=null),this.lis.push({pid:e,vid:o,q:t,tot:n,p:i||{}}),this.size+=t},N.prototype.setTotal=function(e,t){e=C(e),this.total=e,this.cur=t},N.prototype.setId=function(e){this.id=e},N.prototype.setUrl=function(e){this.url=e},N.prototype.setURL=function(e){this.url=e},N.prototype.signature=function(){return this.size+"|"+this.total};try{document.body.addEventListener("change",function(e){try{var t=e.target;"email"==t.type&&t.id.startsWith("bx-")&&ometria&&V(t.value)&&(ometria.identify(t.value),A("bx:signup",{}))}catch(e){}},!1)}catch(e){l(e)}void 0!==u.cookie_domain&&u.cookie_domain||(u.cookie_domain="."+T(I()));var p={},m={},f=null,g=new R("ometria",365,u.cookie_domain);t&&(p.debug=1),e=q("OMuser"),a=function(){var e=q("OMud");try{return e?JSON.parse(e):null}catch(e){return null}}(),e&&(g.existed=!0,e=e.split("|"),g.set("cid",e[0]),g.set("sid",e[1]),g.set("slt",parseInt(e[2])),g.set("nses",parseInt(e[3])),g.set("src",(e[4]||"").replace(/\*/g,"|")),M("OMuser")),a&&(g.existed=!0,g.set("uiid",a.id),M("OMud")),g.saveIfDirty(),p.cor=O(16),g.get("cid")||(s("NEW COOKIE ID"),ee()),p.cid=g.get("cid"),p.uiid=g.get("uiid"),p.uiid?s("Identified: "+p.uiid):s("Not identified"),p.dtouch="ontouchstart"in window||"onmsgesturechange"in window?1:0,p.dsize=screen.width+"x"+screen.height,p.enc=document.characterSet||document.charset;var U,n,e=I(),a=I(document.referrer),y=(a==e&&(a=null),T(e)),h=T(a),v=L(window.location.search),j=(v.contains("om_user")?window.setTimeout(function(){ometria.identify(v.get("om_user")),window.history&&window.history.replaceState&&window.history.replaceState({},"",location.href.replace(/om_user=[^&]+&?/,""))},100):v.contains("om_profile")?window.setTimeout(function(){ometria.identify("omid:"+v.get("om_profile")),window.history&&window.history.replaceState&&window.history.replaceState({},"",location.href.replace(/om_profile=[^&]+&?/,""))},100):v.contains("kmi")&&window.setTimeout(function(){ometria.identify(v.get("kmi"))},100),function(e){return e.contains("om_campaign")?e.get("om_campaign"):""}(v)),B=Math.floor((new Date).getTime()/1e3),w=g.getInt("slt",0),H=!1,_=!1,b=!1;if((w=B-w)>=u.session_timeout&&(_=!0),a&&y!=h){H=!0,p.rurl=a,600<w&&(_=!0),v.contains("utm_nooverride")&&(_=!1);for(var x=0;x<u.payment_domains.length;x++)-1<h.indexOf(u.payment_domains[x])&&(_=!1)}a&&y==h&&w<1.95*u.session_timeout&&(_=!1),w<=600&&(_=!1),(_=p.cnew?!0:_)?(p.snew=1,y=u.key,U=O(12),n=(new Date).getTime()/1e3-1388534400,n=Math.floor(n/2592e3),y=y.substring(0,3)+y.substring(y.length-3),g.set("sid",y+n+U),s("NEW SESSION: "+g.get("sid")),g.inc("nses"),g.set("npv",0),g.set("tids",""),a&&!H&&!p.cnew||(b=!0)):s("EXISTING SESSION: "+g.get("sid")),(b=j?!0:b)&&((y=Q(e,a))||3<=function(e){return e&&7<=(e=e.split("|")).length?(e=parseInt(e[6]),$()-e):null}(g.get("src"))?(s("SOURCE CHANGED: "+g.get("sid")),g.set("ecamp",j),g.set("src",y),p.cnew&&g.set("osrc",y)):s("SOURCE CONTINUED: "+g.get("sid"))),g.set("slt",B),p.tlast=w,p.sid=g.get("sid"),p.nses=g.getInt("nses"),p.src=g.get("src"),p.osrc=g.get("osrc"),p.osts=g.get("osts"),p.ecamp=g.get("ecamp",""),p.tids=g.get("tids"),p.url=I(),g.save();var z=!1,F=p.nses&&p.nses<=1,G=null,k={},S=[];S.push(function(){try{document.body.addEventListener("change",function(e){e=e.target;("email"==e.type||e.name&&e.name.match(/email/i))&&ometria&&ometria.identify(e.value)},!1)}catch(e){l(e)}}),S.push(function(){var o=(p||{}).uiid;if(!window.ometria_overlays_enabled){window.ometria_overlays_enabled=!0;var e,t,n,i,S=this;S.a11yImageHasLoaded=!1,S.focusOnLoad=function(){setTimeout(function(){if(S.a11yImageHasLoaded){var e=document.getElementById("om_overlay_a11y_img");if(e)return void e.focus()}e=document.getElementById("om_overlay_email_input");e&&e.focus()},500)},S.cleanup=function(){var e=(S||{}).onKeyUp,e=(e&&document.removeEventListener("keyup",e),(S||{}).onMouseOut),e=(e&&document.removeEventListener("mouseout",e),(S||{}).onTouchStart),e=(e&&document.removeEventListener("touchstart",e),(S||{}).onScroll);e&&document.removeEventListener("scroll",e)};try{S.baseUrl="https://cdn.ometria.com/";var r=((window||{}).location||{}).hash,a=("#om_overlay_debug"!==r&&"#om_overlays_debug"!==r||(S.baseUrl="https://cdn-ometria-com.s3-eu-west-1.amazonaws.com/"),S.isFetchSupported=function(){return"fetch"in window},S.isURLSearchParamsSupported=function(){return"URLSearchParams"in window},S.isPromiseSupported=function(){return"Promise"in window},S.isLocalStorageSupported=function(){return"localStorage"in window},S.isBrowserSupported=function(){return S.isFetchSupported()&&S.isPromiseSupported()&&S.isLocalStorageSupported()&&S.isURLSearchParamsSupported()},S.getLocalStorageKey=function(e){return"om:overlays:".concat(e)},{NUMBER_OF_DISPLAYS:S.getLocalStorageKey("number_of_displays"),HAS_REJECTED:S.getLocalStorageKey("has_rejected"),LAST_DISPLAYED_TIME:S.getLocalStorageKey("last_displayed_time")}),s=(S.incrementNumberOfDisplays=function(){var e=localStorage.getItem(a.NUMBER_OF_DISPLAYS),e=null===e?0:parseInt(e);isNaN(e)&&(e=0);try{localStorage.setItem(a.NUMBER_OF_DISPLAYS,(e+1).toString())}catch(e){}},S.getNumberOfDisplays=function(){var e=localStorage.getItem(a.NUMBER_OF_DISPLAYS);return null===e?0:parseInt(e)},S.setHasRejected=function(){try{localStorage.setItem(a.HAS_REJECTED,"true")}catch(e){}},S.getHasRejected=function(){return"true"===localStorage.getItem(a.HAS_REJECTED)},S.setLastDisplayedTime=function(){try{localStorage.setItem(a.LAST_DISPLAYED_TIME,(new Date).toISOString())}catch(e){}},S.getLastDisplayedTime=function(){return localStorage.getItem(a.LAST_DISPLAYED_TIME)},S.isNowGreaterThanLastDisplayedTimePlusADay=function(){var e=new Date,t=S.getLastDisplayedTime();return null===t||((t=new Date(t)).setDate(t.getDate()+1),t<e)},"".concat(S.baseUrl,"overlays/").concat(u.key,"/data.json"));function E(e,t){for(var n in t)e.setAttribute(n,t[n])}return S.getOverlaySettings=function(){return fetch(s).then(function(e){return 200!==e.status?Promise.reject("Could not fetch overlay settings."):e.json()},function(e){return Promise.reject("Could not fetch overlay settings.")})},S.signup=function(e){return fetch("https://api.ometria.com/overlays/signup",{body:e,headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"post"}).then(function(e){return 202!==e.status?Promise.reject("Could not sign you up!"):Promise.resolve(!0)},function(e){return Promise.reject(!1)})},S.createBackdrop=function(e){var t=document.createElement("div");return t.setAttribute("data-testid","om-overlays-backdrop"),t.style.cssText='font-family:"'.concat(e,'", sans-serif;position: fixed;top: 0;left: 0;width: 100%;height: 100%;background-color: rgba(0,0,0,0.5);z-index: 2147483647;"'),t},S.createContentContainer=function(e,t,n,o){t=S.createElement("div","min-width:300px;position: fixed;top:50%;left:50%;box-sizing:border-box;transform: translate(-50%,-50%);max-width:calc(100% - 80px);max-height:calc(100% - 80px);width: 500px; height: 350px;background-color: ".concat(t,';background-size: cover;background-position:center;background-repeat: no-repeat;background-image: url("').concat(n,'");padding:16px;display:flex;flex-direction:column; justify-content: space-between;z-index:101;overflow:auto;'),e);return void 0!==o&&o&&(S.createImg(n,o,"position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0, 0, 0, 0); border: 0;",t,"om_overlay_a11y_img",0),S.a11yImageHasLoaded=!0),t},S.createTopSection=function(e,t){return S.createElement("div","display: flex;flex-direction:column;overflow:auto;max-height: calc(100vh - 150px);height:100%;justify-content:center;".concat(t),e)},S.createBottomSection=function(e){return S.createElement("div","display: block;flex-direction:column;align-items:space-between;",e)},S.createCloseButton=function(e){var t=S.createElement("div",'display:block;position: absolute;right: 30px;top: 30px;cursor: pointer;height: 22px;width: 22px;background-image: url("'.concat(S.baseUrl,'overlays/assets/close.png");'),e);return t.onkeypress=function(e){13==e.keyCode&&t.click()},E(t,{"data-testid":"om-overlays-close",tabIndex:0}),t},S.createHeader=function(e,t,n,o,i){n=document.createTextNode(n),t=S.createElement("div","color: ".concat(t,";font-size:",o,"px; line-height:",i,"px;display: -webkit-box;-webkit-box-orient: vertical;align-self: center;font-weight: bold;margin-bottom: 15px;width: 100%;word-wrap:break-word;text-overflow: ellipsis;overflow:hidden;"),e);return t.appendChild(n),t},S.createBody=function(e,t,n,o,i,r){t=S.createElement("div","color: ".concat(t,";font-size:",i,"px; line-height:",r,"px;display: -webkit-box;-webkit-line-clamp: ").concat(o,";-webkit-box-orient: vertical;align-self: center;margin-bottom: 30px;width: 100%;word-wrap:break-word;text-overflow: ellipsis;overflow:hidden;"),e),i=document.createTextNode(n);return t.appendChild(i),t},S.createOverlay=function(e,t,n,o){var i=(e||{}).content,r=((i||{}).form||{}).font,a=((i||{}).form||{}).background_image,s=((i||{}).form||{}).background_image_alt_text,c=((((e||{}).content||{}).form||{}).colours||{}).background,l=((i||{}).form||{}).title,u=(l||{}).text,d=(l||{}).fontSize,l=(l||{}).lineHeight,p=((i||{}).form||{}).content,m=(p||{}).text,f=(p||{}).fontSize,p=(p||{}).lineHeight,g=((((e||{}).content||{}).form||{}).colours||{}).content,y=((i||{}).form||{}).input_text,h=(((i||{}).form||{}).colours||{}).title,v=(((i||{}).form||{}).colours||{}).cta_background,w=(((i||{}).form||{}).colours||{}).cta_text,_=((i||{}).form||{}).cta_text,b=((i||{}).form||{}).privacy_policy_link,x=((i||{}).form||{}).privacy_policy_text,i=(((i||{}).form||{}).colours||{}).link,e=(e||{}).id,r=S.createBackdrop(r),c=S.createContentContainer(r,c,a,s),a=S.createElement("div","display: flex;flex-direction: column;width: 80%;height: 100%;align-self:center;justify-content:space-between;",c),s=S.createTopSection(a),a=S.createBottomSection(a),k=S.createCloseButton(c),h=(S.createHeader(s,h,u,d,l),S.createBody(s,g,m,4,f,p),S.createForm(a,e,y,v,w,_,o),S.createElement("div","font-size: 12px; sans-serif;text-align:center;margin-top: 18px;",a)),u=S.createElement("a","color: ".concat(i,";"),h),d=(E(u,{href:b,target:"_blank",rel:"noopener"}),document.createTextNode(x));return u.appendChild(d),document.body.appendChild(r),r.addEventListener("click",t),c.addEventListener("click",function(e){e.stopPropagation()}),k.addEventListener("click",n),r},S.createSuccessOverlay=function(e,t){var n=(e||{}).content,o=((n||{}).successMessage||{}).font,i=((n||{}).successMessage||{}).background_image,r=((n||{}).successMessage||{}).background_image_alt_text,a=((((e||{}).content||{}).successMessage||{}).colours||{}).background,s=((n||{}).successMessage||{}).title,c=(s||{}).text,l=(s||{}).fontSize,s=(s||{}).lineHeight,u=((n||{}).successMessage||{}).content,d=(u||{}).text,p=(u||{}).fontSize,u=(u||{}).lineHeight,e=((((e||{}).content||{}).successMessage||{}).colours||{}).content,n=(((n||{}).successMessage||{}).colours||{}).title,o=S.createBackdrop(o),a=S.createContentContainer(o,a,i,r),i=S.createTopSection(a,"width:80%;align-self:center;justify-content:flex-start;margin-top: 60px;"),r=(S.createElement("div","display: flex;flex-direction:column;align-items:space-between;",a),S.createCloseButton(i));return S.createHeader(i,n,c,l,s),S.createBody(i,e,d,8,p,u),document.body.appendChild(o),o.addEventListener("click",t),a.addEventListener("click",function(e){e.stopPropagation()}),r.addEventListener("click",t),o},S.createForm=function(e,t,n,o,i,r,a){var s=S.createElement("form","display:flex;justify-content:center;flex-direction:column;",e),e=(E(S.createElement("input","",s),{type:"hidden",name:"__overlay_id",value:t}),S.createElement("input","",s)),t=(E(e,{type:"hidden",name:"email",autocomplete:"off"}),S.createElement("div","display:none !important",s)),e=(E(S.createElement("input","",t),{type:"email",name:"__email",autocomplete:"off"}),S.createElement("input","",s)),t=(E(e,{type:"hidden",name:"@account",value:u.key}),S.createElement("input","",s)),e=(E(t,{type:"hidden",name:"@subscription_status",value:"SUBSCRIBED"}),S.createElement("div","display:flex;flex-direction:row; align-self: center;max-width:calc(100% - 10px);flex-wrap:wrap;width:100%;",s)),t=(E(S.createElement("input","font-size: 15px;padding:16px;height:51px;width: 230px;border-radius: 0px;border: 1px solid #C6C6C6;box-sizing: border-box;flex-grow:1;background-color:white;",e,"om_overlay_email_input"),{type:"email",name:"ue",placeholder:n}),S.createElement("button","font-size:14px;width:121px;height:51px;border:0;flex-grow:1;background-color:".concat(o,";color:").concat(i,";"),e)),n=(E(t,{type:"submit","data-testid":"om-overlays-submit"}),t.innerHTML=r,S.createElement("span","display:none;font-size:14px;color: red;padding:5px 0;flex-grow: 1;width: 300px;position: absolute;bottom: 26px; left: 0; text-align: center;",e));E(n,{id:"om-overlays-error-message","data-testid":"om-overlays-error-message"}),n.innerHTML="Please enter a valid email address",s.addEventListener("submit",function(e){e.preventDefault();var e=document.getElementById("om_overlay_email_input"),t=document.getElementById("om-overlays-error-message");if(e&&t){var n=e.value;if(t.style.display="none",!n||!/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(n).toLowerCase()))return e.style.borderColor="red",void(t.style.display="block")}for(var o=[],i=0;i<s.elements.length;++i){var r=s.elements[i];o.push(encodeURIComponent(r.name)+"="+encodeURIComponent(r.value)),"ue"===r.name&&ometria.identify(r.value)}n=o.join("&"),e=new URLSearchParams(n);return a(e),S.focusOnLoad(),!1})},S.createElement=function(e,t,n,o){e=document.createElement(e);return e.style.cssText=t,n.appendChild(e),void 0!==o&&(e.id=o),e},S.createImg=function(e,t,n,o,i,r){var a=document.createElement("img");return a.src=e,a.alt=t,a.style.cssText=n,void 0!==i&&(a.id=i),void 0!==r&&(a.tabIndex=r),o.appendChild(a),a},S.addLinkElementToHead=function(e){var t=document.head,n=document.createElement("link");n.type="text/css",n.rel="stylesheet",n.media="none",n.onload="if(media!='all')media='all'",n.href=e,t.appendChild(n)},S.googleFonts=["Baskerville","Didot","Lato","Montserrat","Open Sans","Roboto"],S.getGoogleFontsStyleSheetFromFont=function(e){return"https://fonts.googleapis.com/css2?family=".concat(e,"&display=swap")},S.addFont=function(e){S.googleFonts.includes(e)&&(e=S.getGoogleFontsStyleSheetFromFont(e),S.addLinkElementToHead(e))},S.onKeyUp=function(e){("key"in(e=e||window.event)?"Escape"===e.key||"Esc"===e.key:27===e.keyCode)&&(null!==S.overlay&&S.onOverlayBackdropClick(),null!==S.successOverlay)&&S.onSuccessOverlayCloseClick()},S.onMouseOut=function(e){!e.toElement&&!e.relatedTarget&&e.clientY<10&&S.tryToDisplayExitOverlay()},S.onTouchStart=function(){S.isOnMobile=!0,document.removeEventListener("touchstart",S.onTouchStart)},S.onScroll=function(){S.isOnMobile&&S.getScrollSpeed()<-200&&S.tryToDisplayExitOverlay()},S.getScrollSpeed=(n=0,i=t=null,function(){return e=window.scrollY,null!==t&&(n=e-t),t=e,clearTimeout(i),i=setTimeout(c,50),n}),document.addEventListener("keyup",S.onKeyUp),S.isValidUrl=function(e){var t=((window||{}).location||{}).href,n=e.filter(function(e){return"Contain"===e.select}),e=e.filter(function(e){return"Contain"!==e.select}),n=0===n.length||n.find(function(e){return t.includes(e.input)}),e=e.every(function(e){return!t.includes(e.input)});return void 0!==n&&!0===e},S.addPreConnectToHead=function(){var e=document.head,t=document.createElement("link"),n=(t.rel="preconnect",t.href="https://fonts.gstatic.com",document.createElement("link"));n.rel="preconnect",n.href="https://fonts.gstatic.com",e.appendChild(t),e.appendChild(n)},S.overlay=null,S.successOverlay=null,S.overlaySettings=null,S.isOnMobile=!1,S.main=function(){l("[!] Overlay Plugin"),S.isBrowserSupported()&&(S.addPreConnectToHead(),S.getOverlaySettings().then(S.onGetOverlaySettingsSuccess,function(e){l("Failed to get overlay settings...")}))},S.onGetOverlaySettingsSuccess=function(e){S.overlaySettings=e;var t=((S.overlaySettings||{}).overlays||[])[0],e=(((t||{}).content||{}).form||{}).font,n=(((t||{}).content||{}).successMessage||{}).font,o=((t||{}).settings||{}).status,i=(((t||{}).settings||{}).show_on_every_page,((t||{}).settings||{}).when_to_display);S.addFont(e),S.addFont(n),t?"Test"===o&&"#om_overlay_debug"!==window.location.hash&&"#om_overlays_debug"!==window.location.hash||("Entry"===i?""===(e=S.validateCanShow())?0===t.settings.display_on_entry_seconds?(S.overlay=S.createOverlay(t,S.onOverlayBackdropClick,S.onOverlayCloseClick,S.onOverlaySubmitClick),"Test"!==o&&(S.incrementNumberOfDisplays(),S.setLastDisplayedTime())):setTimeout(function(){S.overlay=S.createOverlay(t,S.onOverlayBackdropClick,S.onOverlayCloseClick,S.onOverlaySubmitClick),"Test"!==o&&(S.incrementNumberOfDisplays(),S.setLastDisplayedTime())},1e3*t.settings.display_on_entry_seconds):l(e):"Exit"===i&&(setTimeout(function(){document.addEventListener("mouseout",S.onMouseOut)},1e4),document.addEventListener("touchstart",S.onTouchStart),document.addEventListener("scroll",S.onScroll))):(l("Could not get overlay"),S.cleanup())},S.validateCanShow=function(){var e=((S.overlaySettings||{}).overlays||[])[0],t=((e||{}).settings||{}).status,n=((e||{}).settings||{}).show_on_every_page;if(Math.max(document.documentElement.clientWidth||0,window.innerWidth||0)<320)return"Viewport is too small";if("Live"!==t&&"Test"!==t)return"Overlay not enabled!";if(!n&&!S.isValidUrl(e.settings.selected_urls))return"Not a valid URL!";if("Test"!==t){if(o)return"User is already identified";if(!0===S.getHasRejected()&&!1===e.settings.show_if_rejected)return"Ovelay already rejected!";if(null!==S.getLastDisplayedTime()&&!S.isNowGreaterThanLastDisplayedTimePlusADay())return"Already displayed one overlay in past 24h!";if(e.settings.show_overlay_multiple_times&&S.getNumberOfDisplays()>=e.settings.max_form_display)return"Displayed maximum amount of times!"}return""},S.tryToDisplayExitOverlay=function(){var e=((S.overlaySettings||{}).overlays||[])[0],t=S.validateCanShow();""===t?(S.overlay=S.createOverlay(e,S.onOverlayBackdropClick,S.onOverlayCloseClick,S.onOverlaySubmitClick),"Test"!==status&&(S.incrementNumberOfDisplays(),S.setLastDisplayedTime())):l(t)},S.onOverlayBackdropClick=function(){S.overlay.remove(),S.cleanup()},S.onOverlayCloseClick=function(){"Test"!==((((S.overlaySettings||{}).overlays||[])[0]||{}).settings||{}).status&&S.setHasRejected(),S.overlay.remove(),S.cleanup()},S.onOverlaySubmitClick=function(e){S.signup(e),S.overlay.remove(),S.successOverlay=S.createSuccessOverlay(S.overlaySettings.overlays[0],S.onSuccessOverlayCloseClick)},S.onSuccessOverlayCloseClick=function(){S.successOverlay.remove(),S.cleanup()},S.main(),S.focusOnLoad(),S}catch(e){S.cleanup(),l(e)}}function c(){t=null,n=0}}),k.Basket=N,k.track=function(e,t,n){A(e,t,n,"custom")},k.trackAddToBasket=function(e,t,n){t=t||1,(n=n||{}).pid=e,n.q=t,A("addtobasket",n)},k.isNewVisitor=function(){return F},k.basket=null,k.setBasket=function(e){e.lis.forEach(function(e){""===e.vi&&l("Variant ID cannot be empty string")});var t=g.get("bskt"),n=e?e.signature():"";this.basket=e,t!=n&&(g.set("bskt",n),A("setbasket",e))},k.getBasket=function(){return this.basket},k.trackCheckout=function(e,t){(t=t||{}).stage=e,A("checkout",t)},k.trackTransaction=function(e,t){(t=t||{}).tid=e,A("transaction",t),g.appendText("tids",e,"|"),p.tids=g.get("tids")},k.pageview=function(e,t,n){var o;"landing"==t&&(t="homepage"),(p.url=e)!=G&&(G=e,g.inc("npv"),p.npv=g.getInt("npv")),n.rurl=I(document.referrer),n.type=t,A("pageview",n),n=(n=t=e).slice(t.indexOf("?")+1).split("&"),o={},n.map(function(e){e=e.split("=");o[e[0]]=e[1]}),n={},(t=o).prodRecInstance&&(n.onsiteRecInstance=t.prodRecInstance),t.recommendationEngine&&(n.onsiteRecEngine=t.recommendationEngine),t.primaryEngine&&(n.onsiteRecIsPrimaryEngine="true"===t.primaryEngine),0<Object.keys(n).length&&A("rec:click",n)},k.viewProducts=function(e){},k.viewProduct=function(e){A("viewproduct",{pid:e})},k.event=function(e,t,n){},k.identify=function(e,t,n){var o,i,r,a={};(t=t||{})&&(a.profile=t),(V(a.uiid=e)||/omid:.+/.test(e))&&(r=!(i=!0),(i=(o=this.getIdentity())&&e==o?!1:i)&&o&&(r=!0),i?(p.uiid=e,r&&(s("CHANGED IDENTITY"),ee(),p.cnew=0,g.set("osrc",g.get("src")),g.set("nses",1)),A("identify",a,null),g.set("uiid",e)):t&&A("identify",a,null))},k.setProfileData=function(e){var t={};(e=e||{})&&(t.profile=e),t.uiid=ometria.getIdentity(),t.uiid&&A("profile",t,null)},k.getIdentity=function(){return g.get("uiid")||null},k.setPageType=function(e){f=e},k.setPageData=function(e){m=e},k.linkSession=function(e){p.lnk=e?"dsig":""},k.init=function(e,t,n){l("Initialize phase 1 called"),n&&(p.site=n),document.body?k.init2(e,t):setTimeout(function(){k.init(e,t)},25)},k.init2=function(e,t){l("Initialize phase 2 called"),f=e||null,m=t||{};for(var n=0;n<S.length;n++)try{l("Calling plugin: "+n),S[n](),l("Done plugin: "+n)}catch(e){l(e)}var o=I();if(u.page_types)for(n=0;n<u.page_types.length;n++){var i=u.page_types[n],r=new RegExp(i.pattern,"g");o.match(r)&&(f=i.type)}z=!0,this.pageview(o,f,m);for(var a=0;a<c.length;a++){var s=c[a];A(s[0],s[1],s[2],s[3])}"function"==typeof window.onOmetriaLoaded&&window.onOmetriaLoaded()},k._debug=function(){return{sessionId:p.sid,cookieId:p.cid,userIdentity:p.uiid,extra:p}},k._log=function(){return _log},k.observeEmailInputs=function(e){var t=document.querySelectorAll(e);for(l("Observe email input element "+t.length+" found "+e),i=0;i<t.length;++i)t[i].addEventListener("change",function(e){ometria.identify(e.target.value)})},k.setDebugLogging=function(e){D("OMdebug","1",e?1:-1),location.reload()};k.request=function(e){try{var t=e.url,n=e.body?(c=e.body,Object.keys(c).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(c[e])})):null,o=e.headers||[],i=e.method||"POST",r=e.successCallback||function(e){l(e)},a=e.errorCallback||function(e){l(e)},s=new XMLHttpRequest;s.onload=function(){try{var e=JSON.parse(s.response);200!==s.status?a(e):r&&r(e)}catch(e){a(e)}},s.onerror=function(){var e=JSON.parse(s.response);a&&a(e)},s.open(i,t),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.push({"X-Ometria-Account":u.key}),o.forEach(function(e){var t=Object.keys(e)[0];s.setRequestHeader(t,e[t])}),s.send(n)}catch(e){a(e)}var c},k.ajaxFormSubmit=function(e,o,i){e=document.querySelectorAll(e)[0];e.addEventListener("submit",function(e){e.preventDefault();var t=new XMLHttpRequest,n=e.target.elements,e=Object.keys(n).map(function(e){return encodeURIComponent(n[e].name)+"="+encodeURIComponent(n[e].value)});urlEncodedData=e.join("&").replace(/%20/g,"+"),t.onload=function(){var e=JSON.parse(t.response);o&&o(e)},t.onerror=function(){var e=JSON.parse(t.response);i&&i(e)},t.open("POST","https://api.ometria.com/forms/signup/ajax"),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.send(urlEncodedData)})},void 0===window.ometria&&(window.ometria={}),K(window.ometria,k),"function"==typeof ometria.onLoad&&ometria.onLoad()}}function Y(e,t){if(o||document.body&&((o=document.createElement("div")).style.border="1px solid #000",o.style.position="absolute",o.style.top="0px",o.style.right="0px",o.style.background="#666",o.style.padding="0px",o.style.color="#333",o.style.zIndex=2147483650,o.style.width="250px",o.style.maxHeight="400px",o.style.overflow="auto",document.body.appendChild(o)),o){if(r.length){for(var n=0;n<r.length;n++)J(r[n][0],r[n][1]);r=[]}J(e,t)}else r.push([e,t])}function J(e,t){try{var n=document.createElement("div");n.style.border="1px solid #000",n.style.fontSize="11px",n.style.padding="3px",n.style.margin="3px",n.style.background="#fff",n.innerHTML=""+e,t&&n.addEventListener("click",function(e){console.log(t)}),o.appendChild(n)}catch(e){}}function E(n){var e={contains:function(e){return void 0!==n[e]},get:function(e){return n[e]},set:function(e,t){n[e]=t},toObject:function(){var e,t={};for(e in n)n.hasOwnProperty(e)&&(t[e]=n[e]);return t}};return e}function O(e,t){t=t||"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var n="",o=0;o<e;o++){var i=Math.floor(Math.random()*t.length);n+=t.substring(i,i+1)}return n}function K(e,t){for(var n in t)e[n]=t[n]}function C(e){var t;return"string"==typeof e?!e||(t=parseFloat(e.replace(/[^0-9\.]/g,"")),isNaN(t))?null:t:e}function Z(e,t){return(e.constructor===Array?function(e,t){for(var n=[],o=0;o<e.length;o++)n[o]=t(e[o],o);return n}:function(e,t){var n,o={};for(n in e)e.hasOwnProperty(n)&&(o[n]=t(e[n],n));return o})(e,t)}function I(e){return void 0===e&&(e=window.location.href),e=(e+="").split("#")[0]}function T(e){if(!e)return null;e=e.split("/");if(e.length<3)return null;for(var t=e[2],n=0;n<u.remove_domain_prefixes.length;n++){var o=u.remove_domain_prefixes[n];0===t.indexOf(o)&&(t=t.replace(o,""))}return t=t.split(":")[0]}function V(e){return/\S+@\S+\.\S+/.test(e)}function W(e){return-1==e.indexOf("?")?E({}):L(qstr=e.substring(e.indexOf("?")+1))}function L(e){for(var t={},n=(e=(e=(e=0==e.indexOf("?")?e.substring(e.indexOf("?")+1):e).replace(/&amp;/g,"&")).replace(/\+/g,"%20")).split(/\?|&/),o=0;o<n.length;o++){var i=n[o].split("=");try{t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}catch(e){try{i[0]=i[0].replace(/%[0-9A-Z][0-9A-Z]/,""),i[1]=i[1].replace(/%[0-9A-Z][0-9A-Z]/,""),t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}catch(e){}}}return E(t)}function X(e){var t=[];return function n(e,o,i){if(e&&"object"==typeof e){var t=e,r=function(e,t){n(t,o?o+"["+e+"]":e,i)};if(t&&t.push)for(var a=t,s=r,c=0;c<a.length;c++)s(c,a[c]);else if("object"==typeof t){var l,u=t,d=r;for(l in u)u.hasOwnProperty(l)&&d(l,u[l])}}else void 0!==e&&i.push(encodeURIComponent(o)+"="+encodeURIComponent(e))}(e,"",t),t.join("&")}function D(e,t,n,o){var i=new Date,e=e+"=2_"+encodeURIComponent(t);n&&(i.setDate(i.getDate()+n),e+=";expires="+i.toGMTString()),o&&(e+=";domain="+o),e+=";path=/",document.cookie=e}function q(e){var t=document.cookie+"";if(0<t.length){var n=t.indexOf(e+"=");if(-1!=n)return n=n+e.length+1,-1==(c_end=t.indexOf(";",n))&&(c_end=t.length),("2_"==(e=t.substring(n,c_end)).substring(0,2)?(e=e.substring(2),decodeURIComponent):unescape)(e)}return!1}function M(e,t){D(e,"",-1,t)}function R(e,t,n){this.name=e,this.saveto=null,this.changed=!1,this.life=t,this.domain=n,this.existed=!1,this.data=E({}),this.load()}function A(e,t,n,o){var i,r;o=o||"system",z?(K(i={},p),i.d=t,i.type=e,i.channel=o,P(e,t),i=d.encode(X(i)),(r={}).data=i,r.rnd=O(6),r.enc=p.enc,i=u.endpoint+"v"+u.api_version+"/"+u.key+"/event.gif?"+X(r),(new Image).src=i,n&&setTimeout(n,u.callback_timeout)):c.push([e,t,n,o])}function Q(e,t){e=Z(function(e,t){var n=[null,null,null,null,null,null];t&&(o=T(t),!1!==(o=function(e,t){for(var n="360.cn:q|duckduckgo:q|about:terms|alice:qs|aol:q|aol:query|ask:q|avg:q|babylon:q|baidu:wd|biglobe:q|bing:q|cnn:query|comcast:q|conduit:q|daum:q|eniro:search_word|go.mail.ru:q|goo.ne:MT|google:q|images.google:q|incredimail:q|kvasir:q|live:q|lycos:q|lycos:query|mamma:q|msn:q|najdi:q|naver:query|netscape:query|onet:qt|ozu:q|pchome:q|rakuten:qt|rambler:query|search-results:q|search.centrum.cz:q|seznam:q|startsiden:q|terra:query|virgilio:qs|voila:rdata|wp:szukaj|yahoo:p|yahoo:q|yam:k|yandex:text".split("|"),o=W(t),i="."+e+".",r=0;r<n.length;r++){var a=n[r].split(":"),s="."+a[0]+".",c=a[1];if(-1<i.indexOf(s)){s=a[0];if(s=s.charAt(0).toUpperCase()+s.slice(1),o.contains(c))return[o.get(c)||null,s]}}return 0===i.indexOf(".google.")&&["NOT_SUPPLIED","Google"]}(n[0]=o,t)))&&(n[2]="search",n[1]=o[0],n[4]=o[1]);var o=W(e);o.contains("gclid")&&(n[0]||(n[0]="google.com"),n[2]="cpc",n[4]="Google");t&&-1<t.indexOf("/aclk")&&-1<t.indexOf("adurl=")&&(n[2]="cpc",n[4]="Google");o.contains("om_campaign")&&(n[2]="email",n[4]="ometria");o.contains("utm_term")&&(n[1]=o.get("utm_term"));o.contains("utm_medium")&&(n[2]=o.get("utm_medium"));o.contains("utm_campaign")&&(n[3]=o.get("utm_campaign"));o.contains("utm_source")&&(n[4]=o.get("utm_source"));o.contains("utm_content")&&(n[5]=o.get("utm_content"));return n}(e,t),function(e,t){return!0===e||!1===e||null===e?"":(e+"").replace("|","")}).join("|");return"|||||"==e?"":e+"|"+$()}function $(){var e=(new Date).getTime();return Math.floor(e/864e5)}function N(){this.lis=[],this.total=0,this.size=0,this.id=null,this.cur="",this.p={},this.url=null}function ee(){var e=O(16),e=(g.set("cid",e),p.cid=e,g.set("nses",0),Math.floor((new Date).getTime()/1e3));g.set("osts",e),p.cnew=1}}();